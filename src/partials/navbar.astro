---
import { Image } from "astro:assets";
import logo from "./images/logo.png";
import ChevronDownIcon from "../sections/icons/chevron-down-icon.astro";
import HamburgerIcon from "../sections/icons/hamburger-icon.astro";

const menuItems = [
  { label: "Start", url: "/" },
  {
    label: "Oferta",
    children: [
      {
        category: "Programy do faktur - Windows",
        links: [
          {
            label: "Faktura VAT 2026 START",
            url: "/program-faktura-vat-start/",
          },
          {
            label: "Faktura VAT 2026 STANDARD",
            url: "/program-faktura-vat-standard/",
          },
          {
            label: "Faktura VAT 2026 PRO",
            url: "/program-faktura-vat-pro/",
          },
          {
            label: "Porównaj funkcje i ceny naszych programów",
            url: "/cennik-faktura-vat/",
          },
          {
            label: "Co nowego w programie?",
            url: "/co-nowege-w-programie-do-fakturowania/",
          },
          {
            label: "Fakturowanie z magazynem",
            url: "/program-faktura-vat-pro/",
          },
          { label: "Program do Umów", url: "/program-do-umow/" },
          {
            label: "HDI - Handlowy dokument identyfikacyjny",
            url: "/handlowy-dokument-identyfikacyjny-hdi/",
          },
        ],
      },
      {
        category: "Programy do faktur - Online",
        links: [
          {
            label: "Mobilna Faktura (wersja BETA)",
            url: "/fakturowanie-online/",
          },
          {
            label: "Synchronizacja z Mobilna Faktura",
            url: "/eksport-i-import-danych-do-mobilna-faktura-pl-synchronizacja/",
          },
          {
            label: "Cennik",
            url: "/cennik-faktura-vat/",
          },
        ],
      },
    ],
  },
  {
    label: "Pobierz Programy",
    children: [
      {
        links: [
          {
            label: "Pobierz program Faktura VAT",
            url: "/bezplatne-wersje-demonstracyjne/",
          },
          {
            label: "Instrukcja instalacji programu Faktura VAT 2026",
            url: "/instrukcja-instalacji-programu-faktura-vat-2023/",
          },
        ],
      },
    ],
  },
  {
    label: "Sklep",
    children: [
      {
        links: [
          {
            label: "Cennik - Faktura VAT",
            url: "/cennik-faktura-vat/",
          },
          {
            label: "Zamów nową licencję",
            url: "/sklep/",
          },
          {
            label: "Odnowienie licencji i aktualizacja",
            url: "/kategoria-produktu/aktualizacje/",
          },
        ],
      },
    ],
  },
  { label: "Blog", url: "/blog/" },
  {
    label: "Pomoc",
    children: [
      {
        links: [
          {
            label: "Filmy instruktażowe",
            url: "/user/rafsoftNET",
          },
          {
            label: "Dokumentacja",
            url: "/dokumentacja/faktura-vat-2020-wprowadzenie/",
          },
          {
            label: "FAQ",
            url: "/dokumentacja/faq/",
          },
          {
            label: "Pomoc techniczna K24",
            url: "/pomoc/kontakt/",
          },
          {
            label: "Kontakt",
            url: "/kontakt/",
          },
        ],
      },
    ],
  },
];
---

<nav
  class="fixed top-0 w-full z-50 transition-all duration-300 bg-[#03579a] text-white py-6"
>
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
    <div class="flex items-center justify-between">
      <!-- LOGO -->
      <div class="shrink-0 flex items-center">
        <a href="/" class="w-[162px]">
          <Image
            src={logo}
            alt="Faktura VAT"
            height={logo.height}
            width={logo.width}
            loading="eager"
          />
        </a>
      </div>

      <div class="flex items-center space-x-6">
        <!-- DESKTOP MENU -->
        <div class="hidden md:flex items-center space-x-6">
          {
            menuItems.map((item) => {
              if (item.children) {
                const hasMultipleCategories = item.children.length > 1;

                return (
                  <div class="relative inline-block group">
                    <button class="text-white hover:text-[#18abbd] font-medium text-[16px] flex items-center gap-1">
                      {item.label}
                      <ChevronDownIcon />
                    </button>

                    {/* DROPDOWN WRAPPER */}
                    <div
                      class="absolute left-1/2 -translate-x-1/3 top-full pt-4
                           opacity-0 invisible pointer-events-none
                           group-hover:opacity-100 group-hover:visible group-hover:pointer-events-auto
                           transition-all duration-200"
                    >
                      {/* DROPDOWN PANEL */}
                      <div
                        class="bg-[#192a3d] text-white shadow-2xl border border-slate-700
                             px-8 py-6 w-auto max-w-[90vw]"
                      >
                        <div class="grid grid-flow-col auto-cols-max gap-8">
                          {item.children.map((cat, catIndex) => (
                            <div
                              class={`flex flex-col ${
                                hasMultipleCategories && catIndex === 0
                                  ? "border-r border-slate-700 pr-8"
                                  : hasMultipleCategories
                                    ? "pl-2"
                                    : ""
                              }`}
                            >
                              {cat.category && (
                                <p class="font-semibold text-gray-200 mb-3 text-[15px]">
                                  {cat.category}
                                </p>
                              )}

                              <ul class="space-y-1">
                                {cat.links.map((link) => (
                                  <li class="border-b border-dashed border-slate-700/60 last:border-b-0">
                                    <a
                                      href={link.url}
                                      class="block text-[15px] py-3 text-[#e3e3e3] hover:text-[#007281] font-poppins font-normal"
                                    >
                                      {link.label}
                                    </a>
                                  </li>
                                ))}
                              </ul>
                            </div>
                          ))}
                        </div>
                      </div>
                    </div>
                  </div>
                );
              } else {
                return (
                  <a
                    href={item.url}
                    class="text-[#e3e3e3] hover:text-[#007281] font-medium text-[16px]"
                  >
                    {item.label}
                  </a>
                );
              }
            })
          }
        </div>

        <!-- LANGUAGE + CTA -->
        <div class="hidden md:flex items-center space-x-4">
          <div class="relative">
            <button class="flex items-center gap-2 pl-4">
              <img
                alt="PL"
                class="w-6 h-auto shadow-sm"
                src="https://flagcdn.com/w40/pl.png"
              />
              <ChevronDownIcon />
            </button>
          </div>
          <a
            href="/bezplatne-wersje-demonstracyjne/"
            class="bg-[#d41717] hover:bg-[#c60808] text-white px-5 py-2.5 rounded text-sm font-bold shadow-lg"
          >
            Bezpłatne wersje programów
          </a>
        </div>

        <!-- MOBILE MENU BUTTON -->
        <div class="md:hidden">
          <button class="text-white">
            <HamburgerIcon/>
          </button>
        </div>
      </div>
    </div>
  </div>
</nav>
